#include "source.cpp"

void implicitSurface(const double* x, double* y, double* Df) {
    // funkcja dana jest wzorem f(a,b,c) = (a+b+c)/(a^2+b^2+c^2)-1
    // zmienne pomocnicze
    const double n = x[0] * x[0] + x[1] * x[1] + x[2] * x[2];
    const double s = x[0] + x[1] + x[2];

    // obliczam wartosc funkcji
    *y = s / n - 1.;

    //obliczam pierwszy i jedyny wiersz macierzy
    const double r = 1. / n;
    const double r2 = 2. * (*y) * r;
    Df[0] = r - x[0] * r2;
    Df[1] = r - x[1] * r2;
    Df[2] = r - x[2] * r2;
}

int main() {
    double x[3] = {0.25 * (1. + sqrt(5.)), 0.25 * (1. - sqrt(5.)), 0.5};
    findSurface(implicitSurface, x, 4, 4, 1. / 32, 1. / 32);
    return 0;
}

/**
spodziewane wyjscie:
0.12039238685063169 -0.27776699437494745 0.53125000000000000 
0.12427103856508417 -0.27776699437494745 0.56250000000000000 
0.13082600313543147 -0.27776699437494745 0.59375000000000000 
0.14020352633612365 -0.27776699437494745 0.62500000000000000 

0.06212351672030310 -0.24651699437494745 0.53125000000000000 
0.06548172983245609 -0.24651699437494745 0.56250000000000000 
0.07113718439412973 -0.24651699437494745 0.59375000000000000 
0.07918248954042481 -0.24651699437494745 0.62500000000000000 

0.01274589354441671 -0.21526699437494745 0.53125000000000000 
0.01576154969082753 -0.21526699437494745 0.56250000000000000 
0.02082981701922552 -0.21526699437494745 0.59375000000000000 
0.02801681517470467 -0.21526699437494745 0.62500000000000000 

-0.03023031684944523 -0.18401699437494745 0.53125000000000000 
-0.02746042638880794 -0.18401699437494745 0.56250000000000000 
-0.02281133203696253 -0.18401699437494745 0.59375000000000000 
-0.01623226497988585 -0.18401699437494745 0.62500000000000000  
*/